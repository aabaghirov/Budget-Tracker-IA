{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
	<h1 class="display-4">Hello, {{ current_user.username }}!</h1>
	<p class="lead">Welcome to Budget Tracker. This app helps you manage your income and expenses, categorize transactions, and keep track of your financial health. All your data is private and only visible to you.</p>
	<div class="alert alert-info mt-3" role="alert">
		<strong>Current Balance:</strong> ${{ '%.2f'|format(balance) }}
	</div>
	<hr>

	<!-- Pie Chart for expenditures -->
	<div class="mb-4">
		<h4>Expenditure Breakdown</h4>
	<canvas id="expensePieChart" style="width:180px; height:180px;"></canvas>
	</div>

	<!-- Existing dashboard buttons and content will appear below -->
	{{ super() }}
</div>

{% block scripts %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
	const chartLabels = {{ chart_labels|tojson|safe }};
	const chartData = {{ chart_data|tojson|safe }};
	const ctx = document.getElementById('expensePieChart').getContext('2d');
	const expensePieChart = new Chart(ctx, {
		type: 'pie',
		data: {
			labels: chartLabels,
			datasets: [{
				data: chartData,
				backgroundColor: [
					'#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'
				],
			}]
		},
		options: {
			responsive: false,
			plugins: {
				legend: {
					position: 'bottom',
				},
				title: {
					display: true,
					text: 'Your Spending by Category (Expenses Only)'
				}
			}
		}
	});
</script>
{% endblock %}
{% endblock %}
